# https://taskfile.dev

version: "3"

vars:
  FIBERV2_URL: https://raw.githubusercontent.com/attapon-th/go-project-template/main/tlp/fiberv2

tasks:
  goinit:
    cmds:
      - task: tools
      - git init
      - curl -SL "{{.FIBERV2_URL}}/.gitignore" -o .gitignore
      - curl -SL "{{.FIBERV2_URL}}/.Taskfile.yaml" -o .Taskfile.yaml
      - |
        echo "Example GO Module: github.com/your-name/project-name" \
        && read -p 'Input Go Module: ' gopack \
        && go mod init ${gopack}
      - cobra-cli init --viper
      - cobra-cli add serv
      - task mod

  tools:
    cmds:
      - go install github.com/spf13/cobra-cli@latest
      - go install github.com/itchyny/gojq/cmd/gojq@latest
      - go install github.com/swaggo/swag/cmd/swag@latest
      - go install github.com/attapon-th/go-tools/gosc@latest

  fiberv2:
    cmds:
      - mkdir -p pkg internal/controller  internal/middleware internal/model internal/route internal/setup
      - curl -SL "{{.FIBERV2_URL}}/.config.yaml" -o .config.yaml
      - curl -SL "{{.FIBERV2_URL}}/internal/setup/fiber.go" -o internal/setup/fiber.go
      - curl -SL "{{.FIBERV2_URL}}/internal/controller/pingController.go" -o internal/controller/pingController.go
      - curl -SL "{{.FIBERV2_URL}}/internal/middleware/middleware.go" -o internal/middleware/middleware.go
      - curl -SL "{{.FIBERV2_URL}}/internal/route/route.go" -o internal/route/route.go
      - curl -SL "{{.FIBERV2_URL}}/Dockerfile" -o ./Dockerfile
      - cobra-cli add serv
      - task mod
      - rm -f Taskfile_Init.yaml
